!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("react")):"function"==typeof define&&define.amd?define(["exports","react"],e):e((n||self).reactTelegramWebApp={},n.react)}(this,function(n,e){function t(n){return n&&"object"==typeof n&&"default"in n?n:{default:n}}var u=/*#__PURE__*/t(e),o=function(){var n;return"undefined"!=typeof window&&null!=(n=window)&&null!=(n=n.Telegram)&&n.WebApp?window.Telegram.WebApp:null},l=e.createContext(o()),r={smoothButtonsTransition:!1,smoothButtonsTransitionMs:10},i=e.createContext(r),c=function(){return{MainButton:{current:null},BackButton:{current:null}}},a=e.createContext({MainButton:{current:null},BackButton:{current:null}}),s=function(){},f=function(n){var t=n.id,u=n.show,o=void 0===u?s:u,l=n.hide,r=void 0===l?s:l,c=n.currentShowedIdRef,a=e.useContext(i),f=a.smoothButtonsTransition,d=a.smoothButtonsTransitionMs;e.useEffect(function(){return o(),c.current=t,function(){f?(c.current=null,setTimeout(function(){c.current||r()},d)):(r(),c.current=null)}},[r,t,c,o,f,d])},d=function(){return e.useContext(l)};function v(){return v=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var u in t)Object.prototype.hasOwnProperty.call(t,u)&&(n[u]=t[u])}return n},v.apply(this,arguments)}n.BackButton=function(n){var t=n.onClick,u=e.useContext(a),o=e.useId(),l=d(),r=null==l?void 0:l.BackButton;return e.useEffect(function(){if(t&&r)return r.onClick(t),function(){r.offClick(t)}},[t,r]),f({show:null==r?void 0:r.show,hide:null==r?void 0:r.hide,currentShowedIdRef:u.BackButton,id:o}),null},n.MainButton=function(n){var t=n.text,u=void 0===t?"CONTINUE":t,o=n.progress,l=void 0!==o&&o,r=n.disable,i=n.disabled,c=void 0!==i&&i,s=n.color,v=n.textColor,p=n.onClick,m=e.useContext(a),w=e.useId(),b=d(),h=null==b?void 0:b.MainButton,C=null==b?void 0:b.themeParams,P=r||c;return e.useEffect(function(){null==h||h.setParams({color:s||(null==C?void 0:C.button_color)||"#fff"})},[s,C,h]),e.useEffect(function(){null==h||h.setParams({text_color:v||(null==C?void 0:C.button_text_color)||"#000"})},[h,C,v]),e.useEffect(function(){null==h||h.setText(u)},[u,h]),e.useEffect(function(){P?null==h||h.disable():P||null==h||h.enable()},[P,h]),e.useEffect(function(){l?null==h||h.showProgress(!1):l||null==h||h.hideProgress()},[l,h]),e.useEffect(function(){if(p)return null==h||h.onClick(p),function(){null==h||h.offClick(p)}},[p,h]),f({show:null==h?void 0:h.show,hide:null==h?void 0:h.hide,currentShowedIdRef:m.MainButton,id:w}),null},n.WebAppProvider=function(n){var t,s,f,d,p=n.children,m=n.options,w=(t=!(null==m||!m.async),f=(s=e.useState(!1))[0],d=s[1],e.useEffect(function(){var n;if(t)if(null!=(n=window.Telegram)&&n.WebApp)d(!0);else{var e="undefined"!=typeof window&&window.TelegramWebviewProxy&&window.TelegramWebviewProxy.postEvent;window.TelegramWebviewProxy?window.TelegramWebviewProxy.postEvent=function(){var n;null==e||e.apply(void 0,[].slice.call(arguments)),null!=(n=window.Telegram)&&n.WebApp&&(d(!0),window.TelegramWebviewProxy.postEvent=e)}:window.TelegramWebviewProxy={postEvent:function(){var n;null==e||e.apply(void 0,[].slice.call(arguments)),null!=(n=window.Telegram)&&n.WebApp&&(d(!0),delete window.TelegramWebviewProxy)}}}},[t]),f),b=e.useMemo(function(){return v({},r,m)},[m]),h=e.useMemo(c,[]),C=e.useMemo(o,[w]);return e.useEffect(function(){if(null!=m&&m.smoothButtonsTransition){var n=function(){var n,e;null==C||null==(n=C.MainButton)||n.hide(),null==C||null==(e=C.BackButton)||e.hide()};return window.addEventListener("beforeunload",n),function(){return window.removeEventListener("beforeunload",n)}}},[C,null==m?void 0:m.smoothButtonsTransition]),u.default.createElement(a.Provider,{value:h},u.default.createElement(l.Provider,{value:C},u.default.createElement(i.Provider,{value:b},p)))},n.useCloudStorage=function(){var n,t=null==(n=d())?void 0:n.CloudStorage,u=e.useCallback(function(n){return new Promise(function(e,u){null==t||t.getItem(n,function(n,t){n?u(n):e(t)})})},[t]),o=e.useCallback(function(n,e){return new Promise(function(u,o){null==t||t.setItem(n,e,function(n,e){!n&&e?u():o(n)})})},[t]),l=e.useCallback(function(n){return new Promise(function(e,u){null==t||t.getItems(n,function(n,t){!n&&t?e(t):u(n)})})},[t]),r=e.useCallback(function(n){return new Promise(function(e,u){null==t||t.removeItem(n,function(n,t){!n&&t?e():u(n)})})},[t]),i=e.useCallback(function(n){return new Promise(function(e,u){null==t||t.removeItems(n,function(n,t){!n&&t?e():u(n)})})},[t]),c=e.useCallback(function(){return new Promise(function(n,e){null==t||t.getKeys(function(t,u){!t&&u?n(u):e(t)})})},[t]);return e.useMemo(function(){return{getItem:u,setItem:o,getItems:l,removeItem:r,removeItems:i,getKeys:c}},[t])},n.useExpand=function(){var n=d(),t=e.useState(null==n?void 0:n.isExpanded),u=t[0],o=t[1];return e.useEffect(function(){if(n){var e=function(e){e.isStateStable&&o(n.isExpanded)};return n.onEvent("viewportChanged",e),function(){return n.offEvent("viewportChanged",e)}}},[n]),[u,e.useCallback(function(){return null==n||null==n.expand?void 0:n.expand()},[n])]},n.useHapticFeedback=function(){var n=d(),t=null==n?void 0:n.HapticFeedback,u=e.useCallback(function(){return null==t?void 0:t.impactOccurred.apply(t,[].slice.call(arguments))},[t]),o=e.useCallback(function(){return null==t?void 0:t.notificationOccurred.apply(t,[].slice.call(arguments))},[t]),l=e.useCallback(function(){return null==t?void 0:t.selectionChanged.apply(t,[].slice.call(arguments))},[t]);return[u,o,l]},n.useInitData=function(){var n=d();return[null==n?void 0:n.initDataUnsafe,null==n?void 0:n.initData]},n.useReadTextFromClipboard=function(){var n=d();return e.useCallback(function(){return new Promise(function(e){null==n||null==n.readTextFromClipboard||n.readTextFromClipboard(e)})},[n])},n.useScanQrPopup=function(){var n=d(),t=e.useCallback(function(){return null==n||null==n.showScanQrPopup?void 0:n.showScanQrPopup.apply(n,[].slice.call(arguments))},[n]);return[t,e.useCallback(function(){return null==n||null==n.closeScanQrPopup?void 0:n.closeScanQrPopup()},[n])]},n.useShowPopup=function(){var n=d();return e.useCallback(function(e){return new Promise(function(t,u){try{null==n||null==n.showPopup||n.showPopup(e,function(n){t(n)})}catch(n){u(n)}})},[n])},n.useSwitchInlineQuery=function(){var n=d();return e.useCallback(function(){return null==n||null==n.switchInlineQuery?void 0:n.switchInlineQuery.apply(n,[].slice.call(arguments))},[n])},n.useThemeParams=function(){var n=d(),t=e.useState(null==n?void 0:n.colorScheme),u=t[0],o=t[1],l=e.useState((null==n?void 0:n.themeParams)||{}),r=l[0],i=l[1];return e.useEffect(function(){if(n){var e=function(){o(n.colorScheme),i(n.themeParams)};return n.onEvent("themeChanged",e),function(){n.offEvent("themeChanged",e)}}},[n]),[u,r]},n.useWebApp=function(){return d()}});
