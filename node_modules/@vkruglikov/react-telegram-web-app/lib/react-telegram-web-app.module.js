import n,{createContext as e,useContext as t,useEffect as o,useState as u,useId as r,useCallback as i,useMemo as l}from"react";var c=function(){var n;return"undefined"!=typeof window&&null!=(n=window)&&null!=(n=n.Telegram)&&n.WebApp?window.Telegram.WebApp:null},a=e(c()),f={smoothButtonsTransition:!1,smoothButtonsTransitionMs:10},d=e(f),s=function(){return{MainButton:{current:null},BackButton:{current:null}}},v=e({MainButton:{current:null},BackButton:{current:null}}),w=function(){},m=function(n){var e=n.id,u=n.show,r=void 0===u?w:u,i=n.hide,l=void 0===i?w:i,c=n.currentShowedIdRef,a=t(d),f=a.smoothButtonsTransition,s=a.smoothButtonsTransitionMs;o(function(){return r(),c.current=e,function(){f?(c.current=null,setTimeout(function(){c.current||l()},s)):(l(),c.current=null)}},[l,e,c,r,f,s])},p=function(){return t(a)},h=function(n){var e=n.text,u=void 0===e?"CONTINUE":e,i=n.progress,l=void 0!==i&&i,c=n.disable,a=n.disabled,f=void 0!==a&&a,d=n.color,s=n.textColor,w=n.onClick,h=t(v),P=r(),g=p(),b=null==g?void 0:g.MainButton,y=null==g?void 0:g.themeParams,T=c||f;return o(function(){null==b||b.setParams({color:d||(null==y?void 0:y.button_color)||"#fff"})},[d,y,b]),o(function(){null==b||b.setParams({text_color:s||(null==y?void 0:y.button_text_color)||"#000"})},[b,y,s]),o(function(){null==b||b.setText(u)},[u,b]),o(function(){T?null==b||b.disable():T||null==b||b.enable()},[T,b]),o(function(){l?null==b||b.showProgress(!1):l||null==b||b.hideProgress()},[l,b]),o(function(){if(w)return null==b||b.onClick(w),function(){null==b||b.offClick(w)}},[w,b]),m({show:null==b?void 0:b.show,hide:null==b?void 0:b.hide,currentShowedIdRef:h.MainButton,id:P}),null},P=function(n){var e=n.onClick,u=t(v),i=r(),l=p(),c=null==l?void 0:l.BackButton;return o(function(){if(e&&c)return c.onClick(e),function(){c.offClick(e)}},[e,c]),m({show:null==c?void 0:c.show,hide:null==c?void 0:c.hide,currentShowedIdRef:u.BackButton,id:i}),null},g=function(){var n=p();return i(function(e){return new Promise(function(t,o){try{null==n||null==n.showPopup||n.showPopup(e,function(n){t(n)})}catch(n){o(n)}})},[n])},b=function(){var n=p(),e=null==n?void 0:n.HapticFeedback,t=i(function(){return null==e?void 0:e.impactOccurred.apply(e,[].slice.call(arguments))},[e]),o=i(function(){return null==e?void 0:e.notificationOccurred.apply(e,[].slice.call(arguments))},[e]),u=i(function(){return null==e?void 0:e.selectionChanged.apply(e,[].slice.call(arguments))},[e]);return[t,o,u]},y=function(){var n=p(),e=u(null==n?void 0:n.colorScheme),t=e[0],r=e[1],i=u((null==n?void 0:n.themeParams)||{}),l=i[0],c=i[1];return o(function(){if(n){var e=function(){r(n.colorScheme),c(n.themeParams)};return n.onEvent("themeChanged",e),function(){n.offEvent("themeChanged",e)}}},[n]),[t,l]},T=function(){var n=p(),e=i(function(){return null==n||null==n.showScanQrPopup?void 0:n.showScanQrPopup.apply(n,[].slice.call(arguments))},[n]);return[e,i(function(){return null==n||null==n.closeScanQrPopup?void 0:n.closeScanQrPopup()},[n])]},B=function(){var n=p();return i(function(){return new Promise(function(e){null==n||null==n.readTextFromClipboard||n.readTextFromClipboard(e)})},[n])},x=function(){var n=p();return i(function(){return null==n||null==n.switchInlineQuery?void 0:n.switchInlineQuery.apply(n,[].slice.call(arguments))},[n])},C=function(){var n=p(),e=u(null==n?void 0:n.isExpanded),t=e[0],r=e[1];return o(function(){if(n){var e=function(e){e.isStateStable&&r(n.isExpanded)};return n.onEvent("viewportChanged",e),function(){return n.offEvent("viewportChanged",e)}}},[n]),[t,i(function(){return null==n||null==n.expand?void 0:n.expand()},[n])]},E=function(){var n,e=null==(n=p())?void 0:n.CloudStorage,t=i(function(n){return new Promise(function(t,o){null==e||e.getItem(n,function(n,e){n?o(n):t(e)})})},[e]),o=i(function(n,t){return new Promise(function(o,u){null==e||e.setItem(n,t,function(n,e){!n&&e?o():u(n)})})},[e]),u=i(function(n){return new Promise(function(t,o){null==e||e.getItems(n,function(n,e){!n&&e?t(e):o(n)})})},[e]),r=i(function(n){return new Promise(function(t,o){null==e||e.removeItem(n,function(n,e){!n&&e?t():o(n)})})},[e]),c=i(function(n){return new Promise(function(t,o){null==e||e.removeItems(n,function(n,e){!n&&e?t():o(n)})})},[e]),a=i(function(){return new Promise(function(n,t){null==e||e.getKeys(function(e,o){!e&&o?n(o):t(e)})})},[e]);return l(function(){return{getItem:t,setItem:o,getItems:u,removeItem:r,removeItems:c,getKeys:a}},[e])};function I(){return I=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(n[o]=t[o])}return n},I.apply(this,arguments)}var k=function(e){var t,r,i,w,m=e.children,p=e.options,h=(t=!(null==p||!p.async),i=(r=u(!1))[0],w=r[1],o(function(){var n;if(t)if(null!=(n=window.Telegram)&&n.WebApp)w(!0);else{var e="undefined"!=typeof window&&window.TelegramWebviewProxy&&window.TelegramWebviewProxy.postEvent;window.TelegramWebviewProxy?window.TelegramWebviewProxy.postEvent=function(){var n;null==e||e.apply(void 0,[].slice.call(arguments)),null!=(n=window.Telegram)&&n.WebApp&&(w(!0),window.TelegramWebviewProxy.postEvent=e)}:window.TelegramWebviewProxy={postEvent:function(){var n;null==e||e.apply(void 0,[].slice.call(arguments)),null!=(n=window.Telegram)&&n.WebApp&&(w(!0),delete window.TelegramWebviewProxy)}}}},[t]),i),P=l(function(){return I({},f,p)},[p]),g=l(s,[]),b=l(c,[h]);return o(function(){if(null!=p&&p.smoothButtonsTransition){var n=function(){var n,e;null==b||null==(n=b.MainButton)||n.hide(),null==b||null==(e=b.BackButton)||e.hide()};return window.addEventListener("beforeunload",n),function(){return window.removeEventListener("beforeunload",n)}}},[b,null==p?void 0:p.smoothButtonsTransition]),n.createElement(v.Provider,{value:g},n.createElement(a.Provider,{value:b},n.createElement(d.Provider,{value:P},m)))},S=function(){var n=p();return[null==n?void 0:n.initDataUnsafe,null==n?void 0:n.initData]},W=function(){return p()};export{P as BackButton,h as MainButton,k as WebAppProvider,E as useCloudStorage,C as useExpand,b as useHapticFeedback,S as useInitData,B as useReadTextFromClipboard,T as useScanQrPopup,g as useShowPopup,x as useSwitchInlineQuery,y as useThemeParams,W as useWebApp};
